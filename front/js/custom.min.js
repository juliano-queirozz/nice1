jQuery(window).on("load", function() {
    $('#preloader').fadeOut(500);
    $('#main-wrapper').addClass('show');

    // if($('body').attr('data-sidebar-position') === "fixed") {
    //     $('.quixnav-scroll').slimscroll({
    //         position: "right",
    //         size: "5px",
    //         height: "100%",
    //         color: "transparent"
    //     });
    // }
});

$(document).ready(function() {
    
    
    $.ajax({
        url: 'http://localhost:8080/read/',
        crossDomain: true, 
        dataType: 'json',
        //contentType: 'Access-Control-Allow-Headers',
        success: function(data) {
            console.info("ENVIANDO...");
            console.log(data);
            //document.querySelector("[name='txtstart']").value = result['geral']
            $('#geral').html(data.geral)
            $('#hospital').html(data.hospital)
            $('#loja').html(data.loja)
            $('#natureza').html(data.geral)
            $('#positivo').html(data.positivo+'%'+"<br><span class='text-success'><i class='ti-hand-point-up'></i>Positivo</span>")
            $('#negativo').html(data.negativo+'%'+"<br><span class='text-danger'><i class='ti-hand-point-down'></i>Negativo</span>")
            $('li')[1].setAttribute('positivo',data.positivo)
            $("#classgeral").attr("class", "progress-bar progress-bar-success w-"+data.geralPercent);
            $("#classhospital").attr("class", "progress-bar progress-bar-primary w-"+data.hospitalPercent);
            $("#classloja").attr("class", "progress-bar progress-bar-warning w-"+data.lojaPercent);

           // var response = jQuery.parseJSON(data);
           
            $.each(data.exames, function(key, exame) 
            {
              let porExame =
            
                  '<div class="progress-content py-2"> '+
                      '<div class="row"> '+
                          '<div class="col-lg-10"> '+
                              '<div class="progress-text">'+exame.exame+'</div> '+
                          '</div> '+
                          '<div class="col-lg-8"> '+
                              '<div class="current-progressbar"> '+
                                  '<div class="progress"> '+
                                     '<div class="progress-bar progress-bar-primary w-'+exame.porcentagemGrafico+'" role="progressbar" aria-valuenow="'+exame.porcentagemGrafico+'" aria-valuemin="0" aria-valuemax="100">'+exame.porcentagem+'%</div> '+
                                  '</div> '+
                              '</div> '+
                          '</div> '+
                      '</div> '+
                  '</div> ';
                $("#porExame").append(porExame);
            });
    
            $.each(data.lojas, function(key, loja) 
            {
              let porLoja =
            
                  '<div class="progress-content py-2"> '+
                      '<div class="row"> '+
                          '<div class="col-lg-10"> '+
                              '<div class="progress-text">'+loja.loja+'</div> '+
                          '</div> '+
                          '<div class="col-lg-8"> '+
                              '<div class="current-progressbar"> '+
                                  '<div class="progress"> '+
                                     '<div class="progress-bar progress-bar-primary w-'+loja.porcentagemGrafico+'" role="progressbar" aria-valuenow="'+loja.porcentagemGrafico+'" aria-valuemin="0" aria-valuemax="100">'+loja.porcentagem+'%</div> '+
                                  '</div> '+
                              '</div> '+
                          '</div> '+
                      '</div> '+
                  '</div> ';
                $("#porLoja").append(porLoja);
            });
        },
        type: 'GET'

    })

  });

  
$( "#target" ).click(function() {
    alert('AQUI')
    $.ajax({
        url: 'http://localhost:8080/read/',
        crossDomain: true, 
        dataType: 'text/csv',
        contentType: 'Access-Control-Allow-Headers',
        success: function(data) {
            alert(data)
            console.log(data);
        },
        type: 'GET'
    })


});
(function($) {
    "use strict";

    $("#menu").metisMenu();

    // $(function() {
    //     AOS.init({
    //         duration: 1500,
    //         easing: 'ease-in-out',
    //     });
    // });

    $("#checkAll").change(function() {
        $("td input:checkbox").prop('checked', $(this).prop("checked"));
    });





    // $('.sidebar-right-inner').slimscroll({
    //     // position: "left",
    //     size: "5px",
    //     height: "100%",
    //     color: "#c6c8c9"
    // });

    $(".nav-control").on('click', function() {

        $('#main-wrapper').toggleClass("menu-toggle");

        $(".hamburger").toggleClass("is-active");
    });

    //to keep the current page active
    $(function() {
        for (var nk = window.location,
                o = $("ul#menu a").filter(function() {
                    return this.href == nk;
                })
                .addClass("mm-active")
                .parent()
                .addClass("mm-active");;) {
            // console.log(o)
            if (!o.is("li")) break;
            o = o.parent()
                .addClass("mm-show")
                .parent()
                .addClass("mm-active");
        }




        $("ul#menu>li").on('click', function() {
            const sidebarStyle = $('body').attr('data-sidebar-style');
            if (sidebarStyle === 'mini') {
                console.log($(this).find('ul'))
                $(this).find('ul').stop()
            }
        })
    });

    $(function() {
        // var win_w = window.outerWidth;
        var win_h = window.outerHeight;
        var win_h = window.outerHeight;
        if (win_h > 0 ? win_h : screen.height) {
            $(".content-body").css("min-height", (win_h + 60) + "px");
        };
    });


    $('a[data-action="collapse"]').on("click", function(i) {
        i.preventDefault(),
            $(this).closest(".card").find('[data-action="collapse"] i').toggleClass("mdi-arrow-down mdi-arrow-up"),
            $(this).closest(".card").children(".card-body").collapse("toggle");
    });

    $('a[data-action="expand"]').on("click", function(i) {
        i.preventDefault(),
            $(this).closest(".card").find('[data-action="expand"] i').toggleClass("icon-size-actual icon-size-fullscreen"),
            $(this).closest(".card").toggleClass("card-fullscreen");
    });



    $('[data-action="close"]').on("click", function() {
        $(this).closest(".card").removeClass().slideUp("fast");
    });

    $('[data-action="reload"]').on("click", function() {
        var e = $(this);
        e.parents(".card").addClass("card-load"),
            e.parents(".card").append('<div class="card-loader"><i class=" ti-reload rotate-refresh"></div>'),
            setTimeout(function() {
                e.parents(".card").children(".card-loader").remove(),
                    e.parents(".card").removeClass("card-load")
            }, 2000)
    });

    const headerHight = $('.header').innerHeight();

    $(window).scroll(function() {
        if ($('body').attr('data-layout') === "horizontal" && $('body').attr('data-header-position') === "static" && $('body').attr('data-sidebar-position') === "fixed")
            $(this.window).scrollTop() >= headerHight ? $('.quixnav').addClass('fixed') : $('.quixnav').removeClass('fixed')
    });

    // $('.sidebar-right-trigger').on('click', function() {
    //     $('.sidebar-right').toggleClass('show');
    // });

})(jQuery);

const qs = new PerfectScrollbar('.quixnav-scroll');
// const sr = new PerfectScrollbar('.sidebar-right-inner');


//plugin bootstrap minus and plus
$('.btn-number').on('click', function(e) {
    e.preventDefault();

    fieldName = $(this).attr('data-field');
    type = $(this).attr('data-type');
    var input = $("input[name='" + fieldName + "']");
    var currentVal = parseInt(input.val());
    if (!isNaN(currentVal)) {
        if (type == 'minus')
            input.val(currentVal - 1);
        else if (type == 'plus')
            input.val(currentVal + 1);
    } else {
        input.val(0);
    }
});